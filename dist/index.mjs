var e=0;function t(t){return"__private_"+e+++"_"+t}function r(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var i=require("lodash/fp"),s=i.flow,n=i.map,u=i.pick,h=i.filter,o=i.sortBy,c=i.groupBy,l=i.mapValues,y=/*#__PURE__*/t("nest"),a=/*#__PURE__*/t("stripEmpties"),f=/*#__PURE__*/function(){function e(){var e=this;Object.defineProperty(this,a,{value:p}),Object.defineProperty(this,y,{writable:!0,value:function(t){return function(i){if(!t.length)return i;var s=t[0],n=t.slice(1);return l(function(t){return r(e,y)[y](n)(t)})(c(s)(i))}}}),this.resetQuery()}var t=e.prototype;return t.select=function(e){return this.selectKeys=[].concat(new Set([].concat(this.selectKeys,e))),this},t.where=function(){var e=[].slice.call(arguments);return this.makeAnd(),"function"==typeof e[0]?(this.query+="(",e[0](this),this.query+=")"):1===e.length?this.query+="(item."+e[0]+")":2===e.length?this.query+="(item."+e[0]+" == "+("string"==typeof e[1]?'"'+e[1]+'"':e[1])+")":3===e.length&&(this.query+="(item."+e[0]+" "+e[1]+" "+("string"==typeof e[2]?'"'+e[2]+'"':e[2])+")"),this},t.orWhere=function(){return this.query+=" || ",this.where.apply(this,[].slice.call(arguments))},t.whereIncludes=function(e,t,r){return void 0===r&&(r=null),this.makeAnd(),null==r?(this.query+="(item."+e+" ? item."+e+".includes('"+t+"') : false)",this):(this.query+="(item."+e+" ? item."+e+".some(element => element."+t+" === '"+r+"') : false)",this)},t.orWhereIncludes=function(e,t,r){return void 0===r&&(r=null),this.query+=" || ",this.whereIncludes(e,t,r),this},t.whereContains=function(e,t){return this.makeAnd(),this.query+="(item."+e+" ? item."+e+".toLowerCase().includes('"+t.toLowerCase()+"') : false)",this},t.orWhereContains=function(e,t){return this.query+=" || ",this.whereContains(e,t),this},t.whereIn=function(e,t){return this.makeAnd(),this.query+="(item."+e+' ? ["'+t.join('", "')+"\"].includes('' + item."+e+") : false)",this},t.orWhereIn=function(e,t){return this.query+=" || ",this.whereIn(e,t),this},t.makeAnd=function(){this.query.slice(-1).includes(")")&&(this.query+=" && ")},t.sort=function(e){return this.sortKeys=[].concat(new Set([].concat(this.sortKeys,e))),this},t.group=function(e){return this.groupKeys=[].concat(new Set([].concat(this.groupKeys,e))),this},t.get=function(e){var t=this;r(this,a)[a]();var i=[];return this.selectKeys.length&&i.push(n(function(e){return u(t.selectKeys)(e)})),this.sortKeys.length&&i.push(o(this.sortKeys)),this.groupKeys.length&&i.push(r(this,y)[y](this.groupKeys)),s.apply(void 0,[h(function(e){return new Function("item","'use strict';return "+t.query+";")(e)})].concat(i))(e)},t.resetQuery=function(){this.query="",this.selectKeys=[],this.sortKeys=[],this.groupKeys=[]},e}();function p(){this.query=this.query.replace(/&& \(\)/g,""),this.query=this.query.replace(/\(\)\s\s&&/g,""),this.query=this.query.replace(/\(\)\s&&/g,"")}export{f as default};
//# sourceMappingURL=index.mjs.map
